/**
 * mintcampus Course Format settings
 *
 * @package    format_mintcampus
 * @version    See the value of '$plugin->version' in the version.php file.
 * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later.
 */
define("format_mintcampus/activitynavigation",["jquery","core/ajax","core/notification","core/str","core/templates","core/modal_factory","core/modal_events","core/pending"],(function($,Ajax,Notification,Str,Templates,ModalFactory,ModalEvents,Pending){return{init:function(cmid){var pendingPromise=new Pending("format_mintcampus/activitynavigation:init");$(".activity-header").length&&Ajax.call([{methodname:"format_mintcampus_get_activity_navigation",args:{cmid:cmid}}])[0].then((function(activitydata){return activitydata})).then((async function(activitydata){$("#mintcampusactivityheader").html(activitydata.activityheader),$("#mintcampusactivityfooter").html(activitydata.activityfooter),0!=activitydata.previouscm&&$("#courseindex-content").find("li[data-id='"+activitydata.previouscm+"']").addClass("pageitem"),$("div.float-right a").removeClass("btn-link").addClass("btn-primary").html(await Str.get_string("captionnext","format_mintcampus")),$("div.float-left a").removeClass("btn-link").addClass("btn-primary").html(await Str.get_string("captionback","format_mintcampus"));const courseid=$("#mintcampuscourserating").attr("data-id");var selector;$("#mintcampuscourserating").click((function(){Ajax.call([{methodname:"format_mintcampus_get_rating",args:{courseid:courseid}}])[0].then((async function(ratingprompt){ModalFactory.create({title:await Str.get_string("courserating","format_mintcampus"),body:ratingprompt.ratingprompt,type:ModalFactory.types.SAVE_CANCEL,large:!0}).then((async function(modal){modal.setSaveButtonText(await Str.get_string("save","core"));function handleInputChange(e){let target=e.target;const min=target.min,max=target.max,val=target.value;target.style.backgroundSize=100*(val-min)/(max-min)+"% 100%"}document.querySelectorAll('input[type="range"]').forEach((input=>{input.addEventListener("input",handleInputChange);let min=input.min,max=input.max,val=input.value;input.style.backgroundSize=100*(val-min)/(max-min)+"% 100%"})),modal.getRoot().on(ModalEvents.save,(async function(e){var submission=$("#mintcampus_comment").val();Ajax.call([{methodname:"format_mintcampus_save_comment",args:{courseid:courseid,submission:submission}}])[0].then((function(){})).always(pendingPromise.resolve).catch(Notification.exception);var rating=$("input[name='stars']:checked").val();Ajax.call([{methodname:"format_mintcampus_save_rating",args:{courseid:courseid,rating:rating}}])[0].then((function(){})).always(pendingPromise.resolve).catch(Notification.exception),Notification.alert(await Str.get_string("ratingsavesuccessheader","format_mintcampus"),await Str.get_string("ratingsavesuccess","format_mintcampus"),await Str.get_string("close","format_mintcampus"))})),modal.getRoot().on(ModalEvents.hidden,(function(){modal.destroy()})),modal.show()})).catch(Notification.exception)})).always(pendingPromise.resolve).catch(Notification.exception)})),(selector="#courseindex",new Promise((resolve=>{if(document.querySelector(selector))return resolve(document.querySelector(selector));const observer=new MutationObserver((mutations=>{document.querySelector(selector)&&(resolve(document.querySelector(selector)),observer.disconnect())}));observer.observe(document.body,{childList:!0,subtree:!0})}))).then((elm=>{$("div.courseindex-section[data-number='0']").first().hide(),Ajax.call([{methodname:"format_mintcampus_get_activity_setting",args:{courseid:courseid}}])[0].then((function(toggledata){toggledata.length>0&&0!=toggledata[0].cmid&&toggledata.forEach((data=>$("#courseindex-content").find("li[data-id='"+data.cmid+"']").removeClass("d-flex").addClass("d-flex-noedit")))})).always(pendingPromise.resolve).catch(Notification.exception)}))})).always(pendingPromise.resolve).catch(Notification.exception)}}}));

//# sourceMappingURL=activitynavigation.min.js.map
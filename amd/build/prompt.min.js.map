{"version":3,"file":"prompt.min.js","sources":["../src/prompt.js"],"sourcesContent":["define(['jquery','core/ajax',\n        'core/notification',\n        'core/str',\n        'core/templates',\n        'core/modal_factory',\n        'core/modal_events',\n        'core/pending'],\n    function ($,Ajax,\n              Notification,\n              Str,\n              Templates,\n              ModalFactory,\n              ModalEvents,\n              Pending) {\n        /**\n         * Init this module which allows activity completion state to be changed via ajax.\n         * @method init\n         * @param {string} fullName The current user's full name.\n         * @private\n         */\n        const init = function () {\n\n            var pendingPromise = new Pending('format_mintcampus/prompt:init');\n\n            $('#mintcampuscourserating').click(function() {\n                const courseid = $(this).attr(\"data-id\");\n\n                //get data for course rating\n                Ajax.call([{\n                    methodname: 'format_mintcampus_get_rating',\n                    args: {courseid: courseid}\n                }])[0].then(function (ratingprompt) {\n\n                    ModalFactory.create({\n                        title: Str.get_string('courserating', 'format_mintcampus'),\n                        body: ratingprompt['ratingprompt'],\n                        type: ModalFactory.types.SAVE_CANCEL,\n                        large: true\n                    }).then(function(modal) {\n                        modal.setSaveButtonText(Str.get_string('save','core'));\n\n                        const rangeInputs = document.querySelectorAll('input[type=\"range\"]')\n\n                        function handleInputChange(e) {\n                            let target = e.target\n                            const min = target.min\n                            const max = target.max\n                            const val = target.value\n\n                            target.style.backgroundSize = (val - min) * 100 / (max - min) + '% 100%'\n                        }\n\n                        rangeInputs.forEach(input => {\n                            input.addEventListener('input', handleInputChange)\n\n                            let min = input.min\n                            let max = input.max\n                            let val = input.value\n\n                            input.style.backgroundSize = (val - min) * 100 / (max - min) + '% 100%'\n                        })\n\n                        // Register the click, space and enter events as activators for the trigger element.\n                        /*$('#mintcampus_radio_box').change(function(){\n                        });*/\n\n                        // Handle save event.\n                        modal.getRoot().on(ModalEvents.save, function(e) {\n\n                            var submission = $('#mintcampus_comment').val();\n\n                            Ajax.call([{\n                                methodname: 'format_mintcampus_save_comment',\n                                args: {courseid: courseid, submission:submission}\n                            }])[0].then(function () {\n\n                            }).always(pendingPromise.resolve)\n                                .catch(Notification.exception);\n\n                            var rating = $(\"input[name='stars']:checked\").val();\n\n                            Ajax.call([{\n                                methodname: 'format_mintcampus_save_rating',\n                                args: {courseid: courseid, rating: rating}\n                            }])[0].then(function () {\n\n                            }).always(pendingPromise.resolve)\n                                .catch(Notification.exception);\n\n                            Notification.alert(\n                                Str.get_string('ratingsavesuccessheader', 'format_mintcampus'),\n                                Str.get_string('ratingsavesuccess', 'format_mintcampus'),\n                                Str.get_string('close', 'format_mintcampus')\n                            );\n\n                        });\n\n                        // Handle hidden event.\n                        modal.getRoot().on(ModalEvents.hidden, function() {\n                            // Destroy when hidden.\n                            modal.destroy();\n                        });\n\n                        modal.show();\n\n                    }).catch(Notification.exception);\n\n                }).always(pendingPromise.resolve)\n                    .catch(Notification.exception);\n            });\n\n        };\n        return {\n            init: init\n        };\n    });\n"],"names":["define","$","Ajax","Notification","Str","Templates","ModalFactory","ModalEvents","Pending","init","pendingPromise","click","courseid","this","attr","call","methodname","args","then","ratingprompt","create","title","get_string","body","type","types","SAVE_CANCEL","large","modal","setSaveButtonText","handleInputChange","e","target","min","max","val","value","style","backgroundSize","document","querySelectorAll","forEach","input","addEventListener","getRoot","on","save","submission","always","resolve","catch","exception","rating","alert","hidden","destroy","show"],"mappings":"AAAAA,kCAAO,CAAC,SAAS,YACT,oBACA,WACA,iBACA,qBACA,oBACA,iBACJ,SAAUC,EAAEC,KACFC,aACAC,IACAC,UACAC,aACAC,YACAC,eAmGC,CACHC,KA7FS,eAELC,eAAiB,IAAIF,QAAQ,iCAEjCP,EAAE,2BAA2BU,OAAM,iBACzBC,SAAWX,EAAEY,MAAMC,KAAK,WAG9BZ,KAAKa,KAAK,CAAC,CACPC,WAAY,+BACZC,KAAM,CAACL,SAAUA,aACjB,GAAGM,MAAK,SAAUC,cAElBb,aAAac,OAAO,CAChBC,MAAOjB,IAAIkB,WAAW,eAAgB,qBACtCC,KAAMJ,aAAY,aAClBK,KAAMlB,aAAamB,MAAMC,YACzBC,OAAO,IACRT,MAAK,SAASU,OACbA,MAAMC,kBAAkBzB,IAAIkB,WAAW,OAAO,kBAIrCQ,kBAAkBC,OACnBC,OAASD,EAAEC,aACTC,IAAMD,OAAOC,IACbC,IAAMF,OAAOE,IACbC,IAAMH,OAAOI,MAEnBJ,OAAOK,MAAMC,eAA+B,KAAbH,IAAMF,MAAcC,IAAMD,KAAO,SARhDM,SAASC,iBAAiB,uBAWlCC,SAAQC,QAChBA,MAAMC,iBAAiB,QAASb,uBAE5BG,IAAMS,MAAMT,IACZC,IAAMQ,MAAMR,IACZC,IAAMO,MAAMN,MAEhBM,MAAML,MAAMC,eAA+B,KAAbH,IAAMF,MAAcC,IAAMD,KAAO,YAQnEL,MAAMgB,UAAUC,GAAGtC,YAAYuC,MAAM,SAASf,OAEtCgB,WAAa9C,EAAE,uBAAuBkC,MAE1CjC,KAAKa,KAAK,CAAC,CACPC,WAAY,iCACZC,KAAM,CAACL,SAAUA,SAAUmC,WAAWA,eACtC,GAAG7B,MAAK,eAET8B,OAAOtC,eAAeuC,SACpBC,MAAM/C,aAAagD,eAEpBC,OAASnD,EAAE,+BAA+BkC,MAE9CjC,KAAKa,KAAK,CAAC,CACPC,WAAY,gCACZC,KAAM,CAACL,SAAUA,SAAUwC,OAAQA,WACnC,GAAGlC,MAAK,eAET8B,OAAOtC,eAAeuC,SACpBC,MAAM/C,aAAagD,WAExBhD,aAAakD,MACTjD,IAAIkB,WAAW,0BAA2B,qBAC1ClB,IAAIkB,WAAW,oBAAqB,qBACpClB,IAAIkB,WAAW,QAAS,yBAMhCM,MAAMgB,UAAUC,GAAGtC,YAAY+C,QAAQ,WAEnC1B,MAAM2B,aAGV3B,MAAM4B,UAEPN,MAAM/C,aAAagD,cAEvBH,OAAOtC,eAAeuC,SACpBC,MAAM/C,aAAagD"}